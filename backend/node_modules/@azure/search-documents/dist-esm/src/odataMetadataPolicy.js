// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
import { BaseRequestPolicy } from "@azure/core-http";
const AcceptHeaderName = "Accept";
/**
 * A policy factory for setting the Accept header to ignore odata metadata
 * @internal
 */
export function odataMetadataPolicy(metadataLevel) {
    return {
        create: (nextPolicy, options) => {
            return new OdataMetadataPolicy(nextPolicy, options, { metadataLevel });
        }
    };
}
class OdataMetadataPolicy extends BaseRequestPolicy {
    constructor(nextPolicy, options, policyOptions) {
        super(nextPolicy, options);
        this.metadataLevel = policyOptions.metadataLevel;
    }
    async sendRequest(webResource) {
        webResource.headers.set(AcceptHeaderName, `application/json;odata.metadata=${this.metadataLevel}`);
        return this._nextPolicy.sendRequest(webResource);
    }
}
//# sourceMappingURL=odataMetadataPolicy.js.map